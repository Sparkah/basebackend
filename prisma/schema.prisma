datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id            Int      @id @default(autoincrement())
  fid           Int      @unique          // This is the new main ID
  username      String?                   // Store their Farcaster handle
  displayName   String?
  pfpUrl        String?
  walletAddress String?  @unique          // Make this Optional (?)
  createdAt     DateTime @default(now())
  runs          Run[]                     // Relation to runs
  critUpgrades  Int
  valueUpgrades Int
  currCoins     Int
  ltimeCoins    Int
  mintedScores MintedScore[]
}

model Run {
  id        Int      @id @default(autoincrement())
  score     Int
  userId    Int      // Link to User ID instead of wallet string
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now())
}

model MintedScore {
  id        Int      @id @default(autoincrement())
  score     Int      @unique // Score is the TokenID
  ownerId   Int
  owner     User     @relation(fields: [ownerId], references: [id])
  txHash    String
  mintedAt  DateTime @default(now())
}